<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listagem</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="cadastro.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg bg-body-tertiary shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="cadastro-tarefas.html">Home</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link active" href="listagem.html">Listagem</a></li>
                    <li class="nav-item"><a class="nav-link" href="registro.html">Novo Registro</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <h2 class="mt-3">Listagem de Tarefas</h2>

        <a href="registro.html" class="btn btn-primary mt-3 mb-3">+ Novo Registro</a>

        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-primary">
                    <tr>
                        <th>Nome</th>
                        <th>Data/Hora</th>
                        <th>Prioridade</th>
                        <th style="width: 15%;">Ações</th>
                    </tr>
                </thead>
                <tbody id="tabela-tarefas"></tbody>
            </table>
        </div>
    </div>

    <!-- MODAL EXCLUIR -->
    <div class="modal fade" id="modalExcluir" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Confirmar Exclusão</h5>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    Tem certeza que deseja excluir este registro?
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button id="btnConfirmarExcluir" class="btn btn-danger">Excluir</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center p-3 mt-4 footer-custom">
        © 2025 My List+ — Todos os direitos reservados.
    </footer>

    <script>
        let idParaExcluir = null;

        // --- VERIFICA SE DEVE CRIAR AS 5 TAREFAS INICIAIS ---
        let tarefasSalvas = JSON.parse(localStorage.getItem("tarefas"));

        if (!tarefasSalvas || tarefasSalvas.length === 0) {
            const tarefasIniciais = [
                {
                    nome: "Estudar Matemática",
                    descricao: "Revisar capítulos do livro.",
                    prioridade: "Alta",
                    dataHora: "2025-04-01T14:00"
                },
                {
                    nome: "Trabalho de História",
                    descricao: "Terminar resumo da Segunda Guerra.",
                    prioridade: "Média",
                    dataHora: "2025-04-02T10:00"
                },
                {
                    nome: "Ler capítulo de Literatura",
                    descricao: "Capítulo 3 de Dom Casmurro.",
                    prioridade: "Baixa",
                    dataHora: "2025-04-03T09:00"
                },
                {
                    nome: "Revisar Química",
                    descricao: "Estudar tabela periódica.",
                    prioridade: "Alta",
                    dataHora: "2025-04-04T16:00"
                },
                {
                    nome: "Projeto de Biologia",
                    descricao: "Pesquisar células eucariontes.",
                    prioridade: "Média",
                    dataHora: "2025-04-05T08:30"
                }
            ];

            localStorage.setItem("tarefas", JSON.stringify(tarefasIniciais));
        }

        // --- CARREGA TAREFAS NA TABELA ---
        function carregarTarefas() {
            let tarefas = JSON.parse(localStorage.getItem("tarefas")) || [];

            let tabela = document.getElementById("tabela-tarefas");
            tabela.innerHTML = "";

            tarefas.forEach((t, index) => {
                tabela.innerHTML += `
                    <tr>
                        <td>${t.nome}</td>
                        <td>${t.dataHora}</td>
                        <td>${t.prioridade}</td>
                        <td>
                            <a href="edicao.html?id=${index}" class="btn btn-warning btn-sm">
                                <i class="bi bi-pencil-square"></i>
                            </a>
                            <button class="btn btn-danger btn-sm" onclick="confirmarExclusao(${index})">
                                <i class="bi bi-trash3"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
        }

        function confirmarExclusao(id) {
            idParaExcluir = id;
            new bootstrap.Modal(document.getElementById("modalExcluir")).show();
        }

        // Não exclui nada
        document.getElementById("btnConfirmarExcluir").onclick = function () {
            idParaExcluir = null;
        };

        // document.getElementById("btnConfirmarExcluir").onclick = function () {
        //     let tarefas = JSON.parse(localStorage.getItem("tarefas")) || [];
        //     tarefas.splice(idParaExcluir, 1);
        //     localStorage.setItem("tarefas", JSON.stringify(tarefas));
        //     carregarTarefas();
        //     idParaExcluir = null;
        // };

        carregarTarefas();
    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
